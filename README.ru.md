# algebraic-multigrid-РУМБА v.0.14

Исходный код алгебраического многосеточного метода (AMG) содержится как составная часть проекта  https://github.com/kirill7785/AliceFlow

AMG-это масштабируемый, эффективный алгоритм для решения дифференциальных уравнений в частных производных (ДУРЧП, PDE), которые являются довольно эллиптическими. Многие различные наборы дифференциальных уравнений в частных производных попадают в эту категорию, включая теплопроводность, механику твердого тела, пористое течение, диффузию частиц и т.д. Для задач вычислительной гидродинамики вязкой несжимаемой жидкости AMG очень хорош для поправки давления.

## Классический алгебраический многосеточный метод (CAMG)

Скорость сходимости многих методов решения систем линейных алгебраических уравнений (СЛАУ) может быть значительно повышена за счет использования методики под названием «многосеточный». Многосеточный процесс включает в себя проведение ранних итераций на мелкой сетке и более поздних итерации на вложенных более грубых «виртуальных» сетках. Результаты затем передаются обратно из грубых сеток на первоначальные более подробные мелкие  сетки. С числовой точки зрения, многосеточный подход предлагает значительное преимущество. Для заданной сетки конкретного конечного размера, итерационные методы являются эффективными только при снижении ошибок, которые имеют длину волны порядка шага сетки (ребро тетраэдра при тетра мешировании, ребро гексаэдра при хекса доминант мешировании). Таким образом, в то время как более короткие длины волны ошибки исчезают довольно быстро, ошибки с большей длиной волны, порядка размера расчётной области, исчезают очень медленно (катострофически медленно). Метод Многосеточный обходит эту проблему, используя ряд грубых сеток (они являются вложенными в первоначальную подробную сетку как матрёшки) таким образом, что имеющиеся компоненты вектора ошибки с большой длиной волны являются коротковолновыми (легко падавляемыми обычным итерационным методом - сглаживателем) на грубых сетках из иерархии вложенности. Для того, чтобы избежать необходимости в грубосеточного меширования геометрии с использованием ряда различных шагов сетки, данная программа использует Алгебраический многосеточный метод.

Реализован собственный алгебраический многосеточный метод РУМБАv.0.14 на основе RS, PMIS или HMIS огрубления.
Алгоритм PMIS полностью распараллелен. Поддерживается усиление многосеточного метода BiCGStab или FGMRes(m) алгоритмами, +ilu(k) сглаживатель.
Используется усечение оператора интерполяции, Порог сильной связи зависящий от номера уровня, смешанная точность
вещественной арифметики float для V -цикла и double для BiCGStab или FGMRes(m). Для RS огрубления реализована 
быстродействующая приоритетная очередь на Фибоначчиевой куче.

## Опции оригинального алгебраического многосеточного метода РУМБА v.0.14

AMG РУМБА v.0.14 имеет большое количество опций способных существенно повлиять на скорость решения и скорость сходимости.
Задание опций сосредоточено в меню ниже:

![alt text](https://github.com/kirill7785/algebraic-multigrid-v.0.14/blob/main/pic/thermal%20launcher.png)

1. strong connection threshold - порог сильной связи. Безусловно, самый важный параметр алгоритма AMG-это -strong connection threshold. Эта опция управляет основным механизмом огрубления: удалением записей из матрицы, просто решая, что они неважны. То, что вы устанавливаете здесь, является барьером: (масштабированное) значение (от 0 до 1) , запись в матрице должна быть проверена в соответствии со значением барьера. Все, что ниже барьера, будет отброшено. Это означает, что установка этого значения на более высокую величину (от 0 до 1) приведет к удалению большей части матрицы. Отбрасывание большего количества записей, как правило, полезно для скорости итераций (т. е. насколько быстро каждое решение СЛАУ с помощью алгоритма РУМБА v.0.14), но может существенно повлиять на качество предварительного обуславливания, поэтому слишком далеко зашедшее завышение порога приведет к общему ухудшению производительности, требуя большего числа линейных итераций.
Включение галочки auto подбирает величину порога автоматичекским образом для каждого уровня сетки отдельно. Из литературы известно что на первых 2 или 3 уровнях сетки можно выставить очень большую величину порога, например 0.98. При активации вкладки auto порог зависит от номера уровня и используются значения предопределенные автором программы.
Снятие галочки auto задаёт для всех уровней одинаковый назначенный пользователем порог.
2. maximum reduced levels. Не рекомендуется менять значение по умолчанию равное нулю. Настройка устарела, в будущем будет удалена.

nvidia CUSP 0.5.1 smoothed aggregation amg memory usage comparison:

![alt text](https://github.com/kirill7785/algebraic-multigrid-method/blob/master/picture/Comparison-of-operator-complexity-SAMG-versus-AMG1R5_ru.png)

![alt text](https://github.com/kirill7785/algebraic-multigrid-method/blob/master/picture/Comparison-of-operator-complexity-РУМБАv0.14-versus-amg1r5.png)

![alt text](https://github.com/kirill7785/algebraic-multigrid-method/blob/master/picture/RS%20coarsening_ru.png)

![alt text](https://github.com/kirill7785/algebraic-multigrid-method/blob/master/picture/RS2.png)
